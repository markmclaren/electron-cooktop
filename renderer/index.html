<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; script-src 'self' 'unsafe-eval' https://cdnjs.cloudflare.com; connect-src 'self' https://cdnjs.cloudflare.com; font-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; img-src 'self' data:; worker-src 'self' blob:;"">
    <title>XML Cooktop - Cross-Platform XML Editor</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/editor/editor.main.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</head>
<body>
    <div id="app">
        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Always-visible vertical sidebar -->
            <div class="activity-bar" id="activity-bar">
                <div style="display:flex;flex-direction:column;height:100%;">
                    <div style="display:flex;flex-direction:column;gap:0;">
                        <button id="btn-toggle-sidebar" class="btn-icon activity-toggle" title="Toggle Code Bits"><i class="bi bi-chevron-left"></i></button>
                        <button id="btn-format" class="btn-icon" title="Format XML (F8)"><i class="bi bi-magic"></i></button>
                        <button id="btn-validate" class="btn-icon" title="Validate (F7)"><i class="bi bi-check2-circle"></i></button>
                        <button id="btn-run-xslt" class="btn-icon" title="Run XSLT (F5)"><i class="bi bi-lightning-charge"></i></button>
                        <button id="btn-run-xslt-save" class="btn-icon" title="Run XSLT and save to file"><i class="bi bi-save"></i></button>
                    </div>
                    <div style="flex:1;"></div>
                        <button id="btn-toggle-dark" class="btn-icon" title="Switch to Dark Mode"><i class="bi bi-moon"></i></button>
                </div>
            </div>
            <!-- Sidebar for Code Bits (Templates) -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h3>Code Bits</h3>
                </div>
                <!-- Template Library -->
                <div class="panel">
                    <div class="panel-content">
                        <div id="template-tree" class="template-tree">
                            <div class="loading">Loading templates...</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Content Area - 2-Pane Layout with Stacked Input -->
            <div class="main-content">
                <div class="pane-layout">
                    <!-- Left Column: XML and XSLT Inputs (Stacked) -->
                    <div class="input-column">
                        <!-- XML Input Pane -->
                        <div class="editor-pane">
                            <div class="pane-header">
                                <span class="pane-title">Input XML</span>
                                <div class="pane-controls">
                                    <button id="btn-open-xml" class="btn-icon" title="Open XML file"><i class="bi bi-folder2-open"></i></button>
                                    <button id="btn-save-xml" class="btn-icon" title="Save XML"><i class="bi bi-save"></i></button>
                                    <button id="btn-copy-source" class="btn-icon" title="Copy XML"><i class="bi bi-clipboard"></i></button>
                                    <button id="btn-clear-source" class="btn-icon" title="Clear XML"><i class="bi bi-trash"></i></button>
                                </div>
                            </div>
                            <div class="pane-content">
                                <div id="editor-xml-input" class="monaco-editor-container"></div>
                            </div>
                        </div>
                        
                        <!-- XSLT Input Pane -->
                        <div class="editor-pane">
                            <div class="pane-header">
                                <span class="pane-title">XSLT Stylesheet</span>
                                <div class="pane-controls">
                                    <button id="btn-open-xslt" class="btn-icon" title="Open XSLT file"><i class="bi bi-folder2-open"></i></button>
                                    <button id="btn-save-xslt" class="btn-icon" title="Save XSLT"><i class="bi bi-save"></i></button>
                                    <button id="btn-copy-stylesheet" class="btn-icon" title="Copy XSLT"><i class="bi bi-clipboard"></i></button>
                                    <button id="btn-clear-stylesheet" class="btn-icon" title="Clear XSLT"><i class="bi bi-trash"></i></button>
                                </div>
                            </div>
                            <div class="pane-content">
                                <div id="editor-xslt-input" class="monaco-editor-container"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Right Column: Output -->
                    <div class="output-column">
                        <div class="editor-pane">
                            <div class="pane-header">
                                <span class="pane-title">Transformed Output</span>
                                <div class="pane-controls">
                                    <button id="btn-save-output" class="btn-icon" title="Save output"><i class="bi bi-save"></i></button>
                                    <button id="btn-copy-output" class="btn-icon" title="Copy output"><i class="bi bi-clipboard"></i></button>
                                </div>
                            </div>
                            <div class="pane-content">
                                <div id="editor-output" class="monaco-editor-container tab-content active" data-tab="code"></div>
                                <div id="html-preview" class="html-preview-container tab-content" data-tab="preview"></div>
                            </div>
                            <div class="pane-tabs">
                                <div class="tab active" data-tab="code">
                                    <span class="tab-label">Code</span>
                                </div>
                                <div class="tab" data-tab="preview">
                                    <span class="tab-label">Preview</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-left">
                <span id="status-file">Ready</span>
            </div>
            <div class="status-right">
                <span id="status-position">Ln 1, Col 1</span>
                <span id="status-language">XML</span>
            </div>
        </div>
    </div>
    
    <!-- Context Menus -->
    <div id="context-menu" class="context-menu" style="display: none;">
        <div class="context-menu-item" data-action="insert-template">Insert Template</div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" data-action="copy-xpath">Copy XPath</div>
        <div class="context-menu-item" data-action="evaluate-xpath">Evaluate XPath</div>
    </div>
    
    <!-- Modal Dialogs -->
    <div id="modal-overlay" class="modal-overlay" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modal-title">Dialog</h3>
                <button id="modal-close" class="btn-icon">Ã—</button>
            </div>
            <div class="modal-content" id="modal-content">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button id="modal-ok" class="btn btn-primary">OK</button>
            </div>
        </div>
    </div>
    
    <!-- Welcome Screen (shown when no files are loaded) -->
    <div id="welcome-overlay" class="welcome-overlay" style="display: none;">
        <div class="welcome-content">
            <h1>XML Cooktop</h1>
            <p>A modern, cross-platform XML editor and XSLT processor</p>
            <div class="welcome-actions">
                <button id="btn-welcome-new" class="btn btn-primary">New XML Document</button>
                <button id="btn-welcome-open" class="btn">Open Existing File</button>
                <button id="btn-welcome-sample" class="btn">Load Sample Data</button>
            </div>
            <div class="welcome-features">
                <div class="feature">
                    <h3>Multi-Pane Interface</h3>
                    <p>Edit XML and XSL side by side with live preview</p>
                </div>
                <div class="feature">
                    <h3>XSLT Processing</h3>
                    <p>Transform XML documents with XSLT stylesheets</p>
                </div>
                <div class="feature">
                    <h3>XPath Console</h3>
                    <p>Test and debug XPath expressions interactively</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
    <script src="js/xml-formatter-bundle.dist.js"></script>
    <script src="js/cooktop.js"></script>
</body>
</html>